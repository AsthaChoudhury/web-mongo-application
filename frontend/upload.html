<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="assets/css/style.css"/>
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css"/>
    <title>Upload Recipes</title>

    <style>
      #editor {
          height: 200px;
          background-color: white;
          margin-top: 10px;
      }

      .ql-container {
          width: 100%; 
      }

      .ql-editor {
          min-height: 150px; 
      }

      .input-group {
          margin-bottom: 20px;
      }
  </style>
</head>
<body>
    <header id="header-container"></header>
    <main class="main">
        <section class="upload">
            <h1 class="heading">Upload Your Recipe</h1>
            <form id="recipeForm" enctype="multipart/form-data" method="POST">
                <div class="recipeForm" > 
                    <div class="input-group">
                        <label for="title">Recipe Title</label>
                        <input type="text" id="title" name="title" required >
                    </div>
                    <div class="input-group">
                      <label for="description">Description</label>
                      <div id="description"></div>
                  </div>
                    <div class="input-group">
                        <label for="prepTime">Prep Time</label>
                        <input type="text" id="prepTime" name="prepTime" required >
                    </div>
                    <div class="input-group">
                        <label for="cookTime">Cook Time</label>
                        <input type="text" id="cookTime" name="cookTime" required >
                    </div>
                    <div class="input-group">
                        <label for="servings">Servings</label>
                        <input type="text" id="servings" name="servings" required >
                    </div>
                    
                    <div class="input-group">
                      <label for="ingredients">Ingredients</label>
                      <div id="ingredients"></div>
                  </div>

                    <div class="input-group">
                        <label for="instructions">Instructions</label>
                        <div id="instructions"></div>
                    </div>

                    <div class="input-group">
                        <label for="category">Category</label>
                        <select id="category" name="category" required>
                            <option value="drinks">Drinks</option>
                            <option value="cakes">Cakes</option>
                            <option value="cookies">Cookies</option>
                            <option value="savoury">Savoury</option>
                            <option value="bread">Bread</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label for="image">Upload Image:</label>
                        <input type="file" name="image" id="image" accept="image/*" />
                    </div>

                    <button type="submit">Upload Recipe</button>
                </div>
            </form> 
        </section>
      </main>

      <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
  
      <script type="module">
          import { loadHeader } from './assets/js/loadHeader.js';
          document.addEventListener("DOMContentLoaded", () => {
              loadHeader();
          });
      </script>
  
      <script>
          var quill = new Quill('#instructions', {
              theme: 'snow',
              modules: {
                  toolbar: true
              }
          });

          var quillDescription = new Quill('#description', {
            theme: 'snow',
            modules: {
                toolbar: true
            }
        });

        var quillIngredients = new Quill('#ingredients', {
          theme: 'snow',
          modules: {
              toolbar: true
          }
      });
  
      document.getElementById('recipeForm').onsubmit = function(event) {
        event.preventDefault();  
    
        var instructions = quill.root.innerHTML;
        var description = quillDescription.root.innerHTML;
        var ingredients = quillIngredients.root.innerHTML;
    
        var formData = new FormData(document.getElementById('recipeForm'));
        formData.append('instructions', instructions);
        formData.append('description', description);
        formData.append('ingredients', ingredients);
    
        fetch('/api/upload-recipe', {
          method: 'POST',
          body: formData
        })
        .then(response => response.json())
        .then(data => {
          console.log('Success:', data);
          // Handle success (e.g., redirect or show a success message)
        })
        .catch(error => {
          console.error('Error:', error);
          // Handle error
        });
      };
    </script>
</body>
</html>
