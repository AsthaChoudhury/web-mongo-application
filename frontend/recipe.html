<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="assets/css/style.css"/>
    <link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css"
/>
    <title>Recipe Page</title>
</head>
<body>
    <header id="header-container"></header>

    <main class="main">
        <section class="recipe" id="recipe-detail-section">
        </section>

        <section class="categories">
            <div class="categories__container ">
                    
                    <a href="#" class="category__circle" onclick="loadRecipes('desserts')">
                        <img src="assets/img/dessert.jpg" alt="" class="category__icon">
                        <h3 class="category__title">Desserts</h3>
                    </a>
                    <a href="category.html?category=cakes" class="category__circle">
                        <img src="assets/img/cake.jpg" alt="" class="category__icon">
                        <h3 class="category__title">Cakes</h3>
                    </a>
                    <a href="category.html?category=cookies" class="category__circle">
                        <img src="assets/img/cookies.jpg" alt="" class="category__icon">
                        <h3 class="category__title">Cookies</h3>
                    </a>
                    <a href="category.html?category=savoury" class="category__circle">
                        <img src="assets/img/savoury.jpg" alt="" class="category__icon">
                        <h3 class="category__title">Savoury</h3>
                    </a>
                    <a href="category.html?category=drinks" class="category__circle">
                        <img src="assets/img/drinks.jpg" alt="" class="category__icon">
                        <h3 class="category__title">Drinks</h3>
                    </a>
                    

                <div class="swiper-button-next"></div>
                <div class="swiper-button-prev"></div>
            </div>
        </section>
    </main>
</body>
<script type="module">
    import { loadHeader } from './assets/js/loadHeader.js';
    
    document.addEventListener("DOMContentLoaded", () => {
        loadHeader();
        const params = new URLSearchParams(window.location.search);
        const recipeId = params.get('id');
        
        if (recipeId) {
            loadRecipe(recipeId); 
        } else {
            displayErrorMessage('No recipe ID found!'); 
        }
    });

    async function loadRecipe(recipeId) {
        try {
            const response = await fetch(`http://localhost:3000/api/recipes/${recipeId}`); // Ensure this URL matches your backend
            if (!response.ok) {
                throw new Error('Network response was not ok ' + response.statusText);
            }

            const recipe = await response.json();
            displayRecipe(recipe); // Call displayRecipe function to show data
        } catch (error) {
            console.error("Error fetching recipe data:", error);
            displayErrorMessage('There was an error loading the recipe. Please try again later.');
        }
    }

    function displayRecipe(recipe) {
        const recipeSection = document.getElementById('recipe-detail-section');
        recipeSection.innerHTML = `
        <h2>${recipe.title}</h2>
        <img src="${recipe.image || 'assets/img/default.jpg'}" alt="${recipe.title}" class="recipe__image">
        <p><strong>Description:</strong> ${recipe.description || 'No description available.'}</p>
        <p><strong>Prep Time:</strong> ${recipe.prepTime}</p>
        <p><strong>Cook Time:</strong> ${recipe.cookTime}</p>
        <p><strong>Servings:</strong> ${recipe.servings}</p>
        <h3>Ingredients:</h3>
        <ul>
            ${recipe.ingredients.map(ingredient => `<li>${ingredient}</li>`).join('')}
        </ul>
        <h3>Instructions:</h3>
        <ol>
            ${recipe.method.map(step => `<li>${step}</li>`).join('')}
        </ol>
    `;
}

    function displayErrorMessage(message) {
        const errorMessage = document.getElementById('error-message');
        errorMessage.textContent = message;
        errorMessage.style.display = 'block';
    }
</script>

</body>
</html>